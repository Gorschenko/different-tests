1) Сервер отправляет цифровой сертификат (сертификат сервера), который содержит открытый ключ сервера. Последний в свою очередь подписан центром сертификации (CA).
2) Клиент проверяет сертификат сервера с помощью корневого сертификата, который у него имеется. Последний в свою очередь подписан центром сертификации (CA).
3) После проверки сертификата Клиент генерирует случайный сеансовый ключ (Pre-Master Secret) и шифрует его с помощью открытого ключа сервера, затем отправляет зашифрованный ключ серверу.
4) Закрытый ключ сервера хранится на Севере. С помощью него Сервер расшифровывает данные Клиента, которые Клиент отправил с помощью открытого ключа Сервера.
5) Создание сеансового ключа: Клиент и сервер используют сгенерированный сеансовый ключ для создания общего ключа шифрования, который будет использоваться для защиты данных во время текущего сеанса.

- Keystore содержит сертификаты и закрытые ключи, используемые для аутентификации и шифрования данных на стороне сервера или клиента.
- Truststore содержит сертификаты доверенных CA, которые используются для проверки подлинности сертификатов, полученных от других сторон.