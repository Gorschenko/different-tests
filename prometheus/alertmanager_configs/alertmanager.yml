#  Есть секция global, где указываются
#  шаблоны сообщений и интервалы, когда игнорировать отправку
route:
  # Группировка уведомлений
  group_by: ["alertname"]
  group_wait: 30s
  # Интервал отправки уведомлений в группе
  group_interval: 5m
  # Интервал времени, через который alertmanager напомнит об алерте,
  # если он еще не разрешился
  repeat_interval: 1h
  # Дефолтный отправитель, если не выполнено условие для других
  receiver: "web.hook"
  routes:
    - receiver: "pagerduty-critical"
      group_wait: 10s
      # Условие определение отправителя
      matchers:
        - severity="critical"
        # Применение regexp
        # - severity=~"warning|info"
      # Продолжит проверку условий
      # continue: true
    - receiver: "slack-warning"
      group_wait: 60s
      matchers:
        - severity="warning"
receivers:
  - name: "web.hook"
    webhook_configs:
      - url: "http://127.0.0.1:5001"
  - name: "pagerduty-critical"
    pagerduty_configs:
    - routing_key: "test"
      service_key: "md5-hash"
  - name: "slack-warning"
    slack_configs:
    - api_url: "https://hooks.slack.com/services/token_of_slack"
      channel: "#warnings"
# Позволяет не отправлять алерты, если другие алерты уже существуют
inhibit_rules:
  # Если существует алерт тегом critical,
  # то warning будет игнорироваться
  - source_matchers:
    - severity="critical"
    target_matchers:
    - severity="warning"
    equal: ["instance"]

